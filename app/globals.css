@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --retro-paper: #f4ecda;
  --retro-gold: #ffb96f;
  --retro-blue: #b8ceff;
  --retro-screen-base: #101218;
  --retro-screen-glow: rgba(158, 194, 255, 0.18);
  --scene-aspect-ratio: 2048 / 1365;
  --tv-overlay-left: 45.95%;
  --tv-overlay-top: 34.55%;
  --tv-overlay-width: 21.85%;
  --tv-overlay-height: calc(var(--tv-overlay-width) * 0.97);
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  min-height: 100%;
  padding: 0;
}

body {
  background: #07080f;
  color: var(--retro-paper);
  font-family: var(--font-body), "Segoe UI", sans-serif;
  text-rendering: optimizeLegibility;
  overflow-x: hidden;
}

.retro-scene {
  position: relative;
  min-height: 100svh;
  background: #07080f;
}

.retro-header {
  position: absolute;
  inset: 0 0 auto;
  z-index: 6;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: clamp(1.75rem, 4.2vw, 3.5rem) clamp(0.9rem, 2vw, 1.5rem) 0;
  pointer-events: none;
}

.retro-sound-toggle {
  position: absolute;
  pointer-events: auto;
  top: clamp(1rem, 2.6vw, 1.8rem);
  right: clamp(0.75rem, 2.3vw, 1.4rem);
  display: inline-flex;
  align-items: center;
  gap: 0.42rem;
  min-width: 8.9rem;
  border: 1px solid rgba(132, 96, 63, 0.94);
  border-radius: 3px;
  background:
    linear-gradient(180deg, rgba(89, 57, 35, 0.96), rgba(43, 28, 18, 0.96)),
    repeating-linear-gradient(
      90deg,
      rgba(111, 71, 45, 0.28) 0 5px,
      rgba(71, 43, 26, 0.28) 5px 10px
    );
  color: #f2e4c7;
  font-family: "Courier New", "Lucida Console", monospace;
  font-size: 0.68rem;
  font-weight: 700;
  letter-spacing: 0.11em;
  text-transform: uppercase;
  padding: 0.44rem 0.64rem 0.41rem;
  box-shadow:
    inset 0 1px 0 rgba(255, 226, 173, 0.22),
    inset 0 -1px 0 rgba(20, 11, 7, 0.72),
    0 3px 12px rgba(0, 0, 0, 0.42);
  cursor: pointer;
  transition: transform 140ms ease, filter 140ms ease, border-color 140ms ease, box-shadow 140ms ease;
}

.retro-sound-toggle::before {
  content: "";
  position: absolute;
  inset: 2px;
  border: 1px solid rgba(235, 198, 134, 0.22);
  border-radius: 2px;
  pointer-events: none;
}

.retro-sound-toggle-label {
  opacity: 0.8;
}

.retro-sound-toggle-value {
  min-width: 2.1rem;
  text-align: right;
  color: #ffe9be;
}

.retro-sound-toggle-led {
  width: 0.56rem;
  height: 0.56rem;
  border-radius: 2px;
  border: 1px solid rgba(41, 19, 9, 0.85);
  background: #5b130d;
  box-shadow:
    inset 0 0 0 1px rgba(255, 160, 134, 0.2),
    inset 0 -1px 0 rgba(20, 4, 2, 0.66);
}

.retro-sound-toggle-switch {
  position: relative;
  width: 1.7rem;
  height: 0.88rem;
  border-radius: 2px;
  border: 1px solid rgba(27, 14, 8, 0.86);
  background:
    linear-gradient(180deg, rgba(36, 23, 14, 0.96), rgba(23, 14, 9, 0.98));
  box-shadow:
    inset 0 1px 0 rgba(255, 228, 181, 0.16),
    inset 0 -1px 0 rgba(9, 5, 3, 0.8);
}

.retro-sound-toggle-thumb {
  position: absolute;
  top: 1px;
  left: 1px;
  width: calc(50% - 1px);
  height: calc(100% - 2px);
  border-radius: 1px;
  border: 1px solid rgba(17, 8, 4, 0.84);
  background:
    linear-gradient(180deg, rgba(219, 179, 119, 0.82), rgba(127, 84, 46, 0.88));
  box-shadow:
    inset 0 1px 0 rgba(255, 222, 164, 0.34),
    0 0 0 1px rgba(20, 11, 7, 0.3);
  transition: left 140ms ease, background 140ms ease, box-shadow 140ms ease;
}

.retro-sound-toggle[aria-pressed="true"] {
  border-color: rgba(202, 151, 90, 0.95);
  color: #fff0ce;
  box-shadow:
    inset 0 1px 0 rgba(255, 229, 180, 0.26),
    inset 0 -1px 0 rgba(25, 14, 8, 0.68),
    0 3px 16px rgba(239, 165, 72, 0.22),
    0 3px 12px rgba(0, 0, 0, 0.42);
}

.retro-sound-toggle[aria-pressed="true"] .retro-sound-toggle-led {
  background: radial-gradient(circle at 40% 38%, #ffeeb8 0 24%, #f2ab48 45%, #9f4f14 100%);
  box-shadow:
    0 0 7px rgba(255, 189, 90, 0.9),
    0 0 16px rgba(255, 159, 61, 0.58),
    inset 0 0 0 1px rgba(255, 235, 190, 0.45);
}

.retro-sound-toggle[aria-pressed="true"] .retro-sound-toggle-thumb {
  left: calc(50% + 0px);
  background:
    linear-gradient(180deg, rgba(255, 214, 142, 0.95), rgba(171, 109, 53, 0.92));
  box-shadow:
    inset 0 1px 0 rgba(255, 237, 194, 0.5),
    0 0 8px rgba(244, 166, 73, 0.34);
}

.retro-sound-toggle:hover,
.retro-sound-toggle:focus-visible {
  border-color: rgba(224, 171, 107, 0.9);
  filter: brightness(1.07);
  transform: translateY(-1px);
}

.retro-sound-toggle:active {
  transform: translateY(0);
  filter: brightness(0.96);
}

.retro-room {
  position: relative;
  min-height: 100svh;
  isolation: isolate;
  overflow: hidden;
}

.konami-egg-stage {
  position: fixed;
  inset: 0;
  z-index: 24;
  pointer-events: none;
  overflow: hidden;
  animation: konami-stage-life 5.8s linear forwards;
}

.konami-egg-backdrop {
  position: absolute;
  inset: -8%;
  background:
    radial-gradient(circle at 50% 50%, rgba(255, 250, 214, 0.36), rgba(255, 103, 175, 0.18) 38%, rgba(8, 9, 18, 0.92) 84%),
    repeating-linear-gradient(90deg, rgba(255, 228, 164, 0.14) 0 8px, rgba(255, 138, 217, 0.04) 8px 16px);
  animation: konami-backdrop-pulse 460ms steps(2, end) infinite;
}

.konami-egg-burst {
  position: absolute;
  left: 50%;
  top: 50%;
  width: min(96vw, 900px);
  aspect-ratio: 1 / 1;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background:
    repeating-conic-gradient(
      from 0deg,
      rgba(255, 243, 161, 0.86) 0deg 12deg,
      rgba(255, 126, 196, 0.78) 12deg 24deg,
      rgba(134, 187, 255, 0.74) 24deg 36deg
    );
  filter: blur(1.5px) saturate(1.12);
  opacity: 0.3;
  mix-blend-mode: screen;
  animation: konami-burst-spin 2.2s linear infinite;
}

.konami-egg-banner {
  position: absolute;
  left: 50%;
  top: clamp(2rem, 11vh, 5.8rem);
  margin: 0;
  transform: translateX(-50%);
  padding: 0.24rem 0.8rem;
  font-size: clamp(1.45rem, 6.3vw, 4.3rem);
  letter-spacing: 0.12em;
  line-height: 1.05;
  text-transform: uppercase;
  font-family: "Courier New", "Lucida Console", monospace;
  color: #fff4ce;
  text-align: center;
  text-shadow:
    0 0 8px rgba(255, 238, 196, 0.9),
    0 0 18px rgba(255, 154, 211, 0.72),
    0 0 34px rgba(114, 182, 255, 0.64);
  background: rgba(26, 12, 31, 0.36);
  border: 2px solid rgba(255, 227, 172, 0.7);
  box-shadow:
    0 0 0 2px rgba(23, 8, 33, 0.74) inset,
    0 0 16px rgba(255, 225, 148, 0.42);
  animation: konami-banner-punch 210ms steps(2, end) infinite;
}

.konami-egg-hero {
  position: absolute;
  left: 50%;
  top: 52%;
  transform: translate(-50%, -50%);
  animation: konami-hero-pop 5.8s ease-out forwards;
}

.konami-egg-hero .konami-egg-sprite {
  width: clamp(220px, 36vw, 420px);
  filter:
    drop-shadow(0 10px 20px rgba(0, 0, 0, 0.54))
    drop-shadow(0 0 32px rgba(255, 225, 159, 0.68));
}

.konami-egg-flight {
  position: absolute;
  left: -26vw;
  top: 50%;
  z-index: 2;
  animation: konami-egg-fly 4.1s cubic-bezier(0.12, 0.62, 0.3, 1) forwards;
}

.konami-egg-flight::before {
  content: "";
  position: absolute;
  left: clamp(-34px, -2.9vw, -18px);
  top: 54%;
  width: clamp(8px, 1vw, 12px);
  height: clamp(8px, 1vw, 12px);
  background: #ffe79c;
  box-shadow:
    clamp(-12px, -1.1vw, -8px) clamp(-15px, -1.4vw, -9px) 0 #ffd17a,
    clamp(-26px, -2vw, -14px) clamp(9px, 0.8vw, 6px) 0 #fff2be,
    clamp(-35px, -2.9vw, -18px) clamp(-4px, -0.4vw, -3px) 0 #ffabdf;
  animation: konami-egg-trail 170ms steps(2, end) infinite;
  opacity: 0.92;
}

.konami-egg-flight-a {
  top: 34%;
  animation-delay: 0.06s;
}

.konami-egg-flight-b {
  top: 67%;
  animation-delay: 0.28s;
  animation-duration: 4.5s;
}

.konami-egg-flight-c {
  top: 49%;
  animation-delay: 0.52s;
  animation-duration: 3.8s;
}

.konami-egg-sprite {
  width: clamp(82px, 11vw, 160px);
  aspect-ratio: 1 / 1;
  image-rendering: pixelated;
  animation: konami-egg-bob 120ms steps(2, end) infinite;
  filter:
    drop-shadow(0 3px 8px rgba(0, 0, 0, 0.45))
    drop-shadow(0 0 12px rgba(255, 232, 172, 0.62));
}

.konami-egg-svg {
  width: 100%;
  height: 100%;
  display: block;
  shape-rendering: crispEdges;
}

.retro-room-scene {
  position: absolute;
  z-index: 1;
  left: 50%;
  top: 50%;
  width: min(100vw, calc(100svh * (var(--scene-aspect-ratio))));
  aspect-ratio: var(--scene-aspect-ratio);
  max-width: 100vw;
  max-height: 100svh;
  transform: translate(-50%, -50%);
}

.retro-room-backdrop,
.retro-room-lamp-haze {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.retro-room-film-grain,
.retro-room-vignette {
  position: absolute;
  inset: 0;
  z-index: 5;
  pointer-events: none;
}

.retro-room-backdrop {
  inset: 0;
  background-image:
    linear-gradient(180deg, rgba(9, 10, 16, 0.08) 0%, rgba(8, 8, 12, 0.18) 100%),
    radial-gradient(54% 50% at 24% 48%, rgba(255, 168, 84, 0.12), transparent 66%),
    radial-gradient(48% 42% at 79% 26%, rgba(94, 128, 194, 0.1), transparent 72%),
    var(--scene-image);
  background-size: auto, auto, auto, 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
  filter: saturate(0.95) contrast(1.03) brightness(0.99);
}

.retro-room-lamp-haze {
  background:
    radial-gradient(42% 34% at 18% 49%, rgba(255, 177, 86, 0.1), transparent 70%),
    radial-gradient(44% 36% at 48% 56%, rgba(255, 147, 67, 0.04), transparent 76%),
    radial-gradient(34% 32% at 78% 36%, rgba(122, 156, 232, 0.05), transparent 72%);
  mix-blend-mode: screen;
  opacity: 0.5;
}

.retro-room-film-grain {
  opacity: 0.08;
  background-image:
    radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.18) 0 1px, transparent 1px),
    radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.12) 0 1px, transparent 1px),
    radial-gradient(circle at 55% 45%, rgba(0, 0, 0, 0.22) 0 1px, transparent 1px);
  background-size: 3px 3px, 4px 4px, 5px 5px;
}

.retro-room-vignette {
  background:
    radial-gradient(circle at 50% 50%, transparent 45%, rgba(8, 8, 11, 0.46) 100%),
    linear-gradient(180deg, rgba(3, 3, 5, 0.02), rgba(2, 2, 3, 0.3));
}

.retro-tv-anchor {
  position: absolute;
  z-index: 3;
  left: var(--tv-overlay-left);
  top: var(--tv-overlay-top);
  width: var(--tv-overlay-width);
  height: var(--tv-overlay-height);
  transform: translate(-50%, -50%);
}

.tv {
  width: 100%;
  height: 100%;
}

.tv-frame {
  position: relative;
  width: 100%;
  height: 100%;
  filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.38));
}

.tv-screen {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
  border-radius: 8% / 10%;
  overflow: hidden;
  background: var(--retro-screen-base);
  box-shadow:
    inset 0 0 0 1px rgba(250, 245, 230, 0.1),
    inset 0 0 44px rgba(0, 0, 0, 0.74),
    inset 0 0 24px var(--retro-screen-glow);
}

.tv-image {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: saturate(0.84) contrast(1.09) brightness(0.92) blur(0.55px);
}

.tv-image.is-cover {
  object-fit: cover;
  transform: scale(1.022);
}

.tv-image.is-contain {
  object-fit: contain;
  transform: scale(1.04);
}

.tv-empty-state {
  display: grid;
  place-items: center;
  width: 100%;
  height: 100%;
  padding: 1rem;
  color: rgba(234, 226, 208, 0.88);
  font-size: clamp(0.72rem, 1.55vw, 0.92rem);
  text-align: center;
  line-height: 1.45;
  background:
    radial-gradient(ellipse at 50% 45%, rgba(118, 138, 177, 0.18), transparent 64%),
    linear-gradient(180deg, #2b303c 0%, #101319 100%);
}

.tv-empty-state code {
  font-size: 0.95em;
}

.crt-effects {
  position: absolute;
  inset: 0;
  z-index: 2;
  pointer-events: none;
}

.fx-vignette,
.fx-scanlines,
.fx-noise,
.fx-rgb-separation,
.fx-flicker,
.fx-static {
  position: absolute;
  inset: 0;
}

.fx-vignette {
  background-image:
    var(--fx-vignette-image),
    radial-gradient(circle at 50% 50%, transparent 52%, rgba(0, 0, 0, 0.52) 100%);
  background-size: cover;
  background-position: center;
  opacity: 0.86;
}

.fx-scanlines {
  background-image:
    var(--fx-scanlines-image),
    repeating-linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.11) 0,
      rgba(255, 255, 255, 0.11) 1px,
      rgba(0, 0, 0, 0.22) 1px,
      rgba(0, 0, 0, 0.22) 3px
    );
  background-size: cover, 100% 3px;
  background-repeat: repeat;
  opacity: 0.24;
  mix-blend-mode: soft-light;
}

.fx-noise {
  opacity: 0.16;
  background-image:
    var(--fx-noise-image),
    radial-gradient(circle at 15% 28%, rgba(255, 255, 255, 0.18) 0 1px, transparent 1px),
    radial-gradient(circle at 74% 66%, rgba(255, 255, 255, 0.12) 0 1px, transparent 1px);
  background-size: cover, 3px 3px, 4px 4px;
  background-repeat: repeat;
  animation: tv-noise-shift 220ms steps(2) infinite;
}

.fx-rgb-separation {
  background:
    linear-gradient(90deg, rgba(255, 47, 77, 0.16), transparent 32%),
    linear-gradient(270deg, rgba(52, 182, 255, 0.16), transparent 32%);
  opacity: 0.13;
  mix-blend-mode: screen;
  filter: blur(0.45px);
}

.fx-flicker {
  background: rgba(255, 255, 255, 0.015);
  animation: tv-flicker 150ms steps(2) infinite;
}

.fx-static {
  opacity: 0;
  background-image:
    var(--fx-static-image),
    linear-gradient(180deg, rgba(231, 233, 236, 0.62), rgba(43, 47, 52, 0.65));
  background-size: cover;
  mix-blend-mode: screen;
}

.crt-effects.is-transitioning .fx-static {
  animation: tv-static-burst 360ms ease-out;
}

.tv-screen.is-transitioning .tv-image {
  animation: tv-image-jolt 360ms ease-out;
}

:focus-visible {
  outline: 2px solid rgba(230, 215, 189, 0.95);
  outline-offset: 3px;
}

@keyframes tv-noise-shift {
  0% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(-2px, 1px);
  }
  100% {
    transform: translate(1px, -2px);
  }
}

@keyframes tv-flicker {
  0% {
    opacity: 0.08;
  }
  35% {
    opacity: 0.03;
  }
  70% {
    opacity: 0.09;
  }
  100% {
    opacity: 0.05;
  }
}

@keyframes tv-static-burst {
  0% {
    opacity: 0;
  }
  25% {
    opacity: 0.95;
  }
  55% {
    opacity: 0.45;
  }
  100% {
    opacity: 0;
  }
}

@keyframes tv-image-jolt {
  0% {
    opacity: 1;
    transform: scale(1.022);
    filter: saturate(0.84) contrast(1.09) brightness(0.92) blur(0.55px);
  }
  24% {
    opacity: 0.62;
    transform: scale(1.03) translateY(-1px);
    filter: saturate(0.78) contrast(1.16) brightness(1.04) blur(0.35px);
  }
  62% {
    opacity: 0.82;
    transform: scale(1.02) translateY(1px);
    filter: saturate(0.84) contrast(1.1) brightness(0.94) blur(0.5px);
  }
  100% {
    opacity: 1;
    transform: scale(1.022);
    filter: saturate(0.84) contrast(1.09) brightness(0.92) blur(0.55px);
  }
}

@keyframes konami-stage-life {
  0% {
    opacity: 0;
  }
  6% {
    opacity: 1;
  }
  88% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

@keyframes konami-backdrop-pulse {
  0% {
    filter: saturate(1) brightness(0.95);
  }
  100% {
    filter: saturate(1.22) brightness(1.12);
  }
}

@keyframes konami-burst-spin {
  0% {
    transform: translate(-50%, -50%) rotate(0deg) scale(0.9);
  }
  100% {
    transform: translate(-50%, -50%) rotate(360deg) scale(1.08);
  }
}

@keyframes konami-banner-punch {
  0% {
    transform: translateX(-50%) scale(1);
  }
  100% {
    transform: translateX(-50%) scale(1.06);
  }
}

@keyframes konami-hero-pop {
  0% {
    transform: translate(-50%, -50%) scale(0.46) rotate(-18deg);
  }
  20% {
    transform: translate(-50%, -50%) scale(1.12) rotate(5deg);
  }
  42% {
    transform: translate(-50%, -50%) scale(0.95) rotate(-3deg);
  }
  100% {
    transform: translate(-50%, -50%) scale(1) rotate(0deg);
  }
}

@keyframes konami-egg-fly {
  0% {
    transform: translate3d(0, 0, 0) rotate(-8deg) scale(0.9);
  }
  100% {
    transform: translate3d(148vw, -7vh, 0) rotate(14deg) scale(1.15);
  }
}

@keyframes konami-egg-bob {
  0% {
    transform: translateY(0) rotate(-2deg);
  }
  100% {
    transform: translateY(-8px) rotate(2deg);
  }
}

@keyframes konami-egg-trail {
  0% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}

@media (max-width: 760px) {
  .retro-header {
    padding-top: clamp(1.25rem, 4vw, 2rem);
  }

  .retro-sound-toggle {
    top: auto;
    bottom: 0.9rem;
    right: 0.8rem;
  }
}

@media (prefers-reduced-motion: reduce) {
  .fx-noise,
  .fx-flicker,
  .crt-effects.is-transitioning .fx-static,
  .tv-screen.is-transitioning .tv-image {
    animation: none !important;
  }

  .retro-sound-toggle {
    transition: none;
  }
}
